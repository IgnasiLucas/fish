counts <- read.table('summary.txt', header=TRUE)
attach(counts)

png(filename='reads.png', width=1000, height=1000)
par(mex=1.7, cex=1.7, cex.main=1.7, cex.lab=1.7, cex.axis=1.7)
plot(MaxN, Passed, type='n', xlab='Max. number of Ns', ylab='Reads that passed')
lines(MaxN[Set=='pe'], Passed[Set=='pe'], lwd=4, col='red')
lines(MaxN[Set=='se'], Passed[Set=='se'], lwd=4, col='blue')
legend(18,310000, c('Paired', 'Merged'), lty=c(1,1), lwd=c(3,3), col=c('red','blue'), cex=1.5)
dev.off()

png(filename='clusters.png', width=1000, height=1000)
par(mex=1.7, cex=1.7, cex.main=1.7, cex.lab=1.7, cex.axis=1.7)
plot(MaxN, Clusters, type='n', xlab='Max. number of Ns', ylab='Clusters')
lines(MaxN[Set=='pe'], Clusters[Set=='pe'], lwd=4, col='red')
lines(MaxN[Set=='se'], Clusters[Set=='se'], lwd=4, col='blue')
legend(18,150000, c('Paired', 'Merged'), lty=c(1,1), lwd=c(3,3), col=c('red','blue'), cex=1.5)
dev.off()

png(filename='depth.png', width=1000, height=1000)
par(mex=1.7, cex=1.7, cex.main=1.7, cex.lab=1.7, cex.axis=1.7)
plot(Passed, Clusters, type="n", xlab='Number of reads', ylab='Number of clusters')
points(Passed[Set=='pe'], Clusters[Set=='pe'], col='red')
points(Passed[Set=='se'], Clusters[Set=='se'], col='blue')
abline(lm(Clusters[Set=='pe'] ~ Passed[Set=='pe']), lwd=4, col='red')
abline(lm(Clusters[Set=='se'] ~ Passed[Set=='se']), lwd=4, col='blue')
legend(500000, 150000, c('Paired', 'Merged'), lty=c(1,1), lwd=c(3,3), col=c('red','blue'), cex=1.5)
dev.off()

